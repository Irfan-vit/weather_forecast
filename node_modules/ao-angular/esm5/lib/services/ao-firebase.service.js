/**
 * @fileoverview added by tsickle
 * Generated from: lib/services/ao-firebase.service.ts
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import * as firebase from 'firebase/app';
import { AOFirebaseFactoryService } from './ao-firebase-factory.service';
import * as i0 from "@angular/core";
import * as i1 from "./ao-firebase-factory.service";
var AOFirebaseService = /** @class */ (function () {
    function AOFirebaseService(_firebase) {
        this._firebase = _firebase;
        this._name = 'master';
    }
    /**
     * @return {?}
     */
    AOFirebaseService.prototype.firebase = /**
     * @return {?}
     */
    function () {
        return this._firebase;
    };
    /**
     * @param {?} configs
     * @return {?}
     */
    AOFirebaseService.prototype.factory = /**
     * @param {?} configs
     * @return {?}
     */
    function (configs) {
        return this._firebase.factory(this.name(), configs);
    };
    /**
     * @return {?}
     */
    AOFirebaseService.prototype.conn = /**
     * @return {?}
     */
    function () {
        return this._firebase.conn(this.name());
    };
    /**
     * @return {?}
     */
    AOFirebaseService.prototype.name = /**
     * @return {?}
     */
    function () {
        return this._name;
    };
    /**
     * @return {?}
     */
    AOFirebaseService.prototype.hash = /**
     * @return {?}
     */
    function () {
        return this.conn().hash();
    };
    /**
     * @return {?}
     */
    AOFirebaseService.prototype.app = /**
     * @return {?}
     */
    function () {
        return this.conn().app();
    };
    // -------------------------------------------------------------------------------------------------------------------
    // -------------------------------------------------------------------------------------------------------------------
    /**
     * @return {?}
     */
    AOFirebaseService.prototype.auth = 
    // -------------------------------------------------------------------------------------------------------------------
    /**
     * @return {?}
     */
    function () {
        return this.conn().auth();
    };
    /**
     * @return {?}
     */
    AOFirebaseService.prototype.authState = /**
     * @return {?}
     */
    function () {
        return this.auth().authState;
    };
    // -------------------------------------------------------------------------------------------------------------------
    // -------------------------------------------------------------------------------------------------------------------
    /**
     * @return {?}
     */
    AOFirebaseService.prototype.db = 
    // -------------------------------------------------------------------------------------------------------------------
    /**
     * @return {?}
     */
    function () {
        return this.conn().database();
    };
    /**
     * @return {?}
     */
    AOFirebaseService.prototype.dbNow = /**
     * @return {?}
     */
    function () {
        return firebase.database.ServerValue.TIMESTAMP;
    };
    // -------------------------------------------------------------------------------------------------------------------
    // -------------------------------------------------------------------------------------------------------------------
    /**
     * @return {?}
     */
    AOFirebaseService.prototype.fs = 
    // -------------------------------------------------------------------------------------------------------------------
    /**
     * @return {?}
     */
    function () {
        return this.conn().firestore();
    };
    /**
     * @return {?}
     */
    AOFirebaseService.prototype.fsId = /**
     * @return {?}
     */
    function () {
        return this.fs().createId();
    };
    /**
     * @template T
     * @param {?} path
     * @return {?}
     */
    AOFirebaseService.prototype.fsDoc = /**
     * @template T
     * @param {?} path
     * @return {?}
     */
    function (path) {
        return this.fs().doc(path);
    };
    /**
     * @param {?} path
     * @return {?}
     */
    AOFirebaseService.prototype.fsDocValue = /**
     * @param {?} path
     * @return {?}
     */
    function (path) {
        return this.fsDoc(path).valueChanges();
    };
    /**
     * @param {?} path
     * @return {?}
     */
    AOFirebaseService.prototype.fsDocSnapshot = /**
     * @param {?} path
     * @return {?}
     */
    function (path) {
        return this.fs().doc(path).snapshotChanges();
    };
    /**
     * @param {?} path
     * @param {?} data
     * @param {?=} options
     * @return {?}
     */
    AOFirebaseService.prototype.fsDocSet = /**
     * @param {?} path
     * @param {?} data
     * @param {?=} options
     * @return {?}
     */
    function (path, data, options) {
        if (options === void 0) { options = { merge: true }; }
        return this.fs().doc(path).set(data, options);
    };
    /**
     * @template T
     * @param {?} path
     * @param {?=} queryFn
     * @return {?}
     */
    AOFirebaseService.prototype.fsCol = /**
     * @template T
     * @param {?} path
     * @param {?=} queryFn
     * @return {?}
     */
    function (path, queryFn) {
        return this.fs().collection(path, queryFn);
    };
    /**
     * @param {?} path
     * @param {?=} queryFn
     * @return {?}
     */
    AOFirebaseService.prototype.fsColValues = /**
     * @param {?} path
     * @param {?=} queryFn
     * @return {?}
     */
    function (path, queryFn) {
        return this.fsCol(path, queryFn).valueChanges();
    };
    /**
     * @param {?} path
     * @param {?=} queryFn
     * @return {?}
     */
    AOFirebaseService.prototype.fsColSnapshot = /**
     * @param {?} path
     * @param {?=} queryFn
     * @return {?}
     */
    function (path, queryFn) {
        return this.fsCol(path, queryFn).snapshotChanges();
    };
    /**
     * @param {?} path
     * @param {?=} queryFn
     * @return {?}
     */
    AOFirebaseService.prototype.fsColState = /**
     * @param {?} path
     * @param {?=} queryFn
     * @return {?}
     */
    function (path, queryFn) {
        return this.fsCol(path, queryFn).stateChanges();
    };
    /**
     * @return {?}
     */
    AOFirebaseService.prototype.fsBatch = /**
     * @return {?}
     */
    function () {
        return this.fs().firestore.batch();
    };
    /**
     * @return {?}
     */
    AOFirebaseService.prototype.fsNow = /**
     * @return {?}
     */
    function () {
        return firebase.firestore.FieldValue.serverTimestamp();
    };
    /**
     * @return {?}
     */
    AOFirebaseService.prototype.fsTimestamp = /**
     * @return {?}
     */
    function () {
        return firebase.firestore.Timestamp;
    };
    // fsToMilliseconds(item, field) {
    //   if (item[field] instanceof Timestamp) {
    //     item[field] = (new Date(item[field].seconds * 1000 + item[field].nanoseconds / 1000000)).getTime();
    //   }
    // }
    // fsAddMilliseconds(date) {
    //   date.milliseconds = (new Date(date.seconds * 1000 + date.nanoseconds / 1000000)).getTime();
    //   return date;
    // }
    // fsTransaction<T>(updateFunction: (transaction: firebase.firestore.Timestamp) => Promise<T>): Promise<T> {
    //   return this.fs().firestore.runTransaction(updateFunction);
    // }
    // fsCounter(path, field = 'count', qt = 1) {
    //   return this.fsTransaction(transaction => {
    //     const ref = this.fsDoc(path).ref;
    //     return transaction.get(ref).then((doc) => {
    //
    //       const update = {};
    //
    //       if (doc.exists) {
    //         const value = parseInt(doc.get(field), 10);
    //         qt = value >= 0 || value <= 0 ? qt + value : qt;
    //       }
    //
    //       update[field] = qt;
    //
    //       transaction.set(ref, update, {merge: true});
    //
    //     });
    //   });
    // }
    // fsUp(path, field = 'count') {
    //   return this.fsCounter(path, field, 1);
    // }
    // fsDown(path, field = 'count') {
    //   return this.fsCounter(path, field, -1);
    // }
    // -------------------------------------------------------------------------------------------------------------------
    // fsToMilliseconds(item, field) {
    //   if (item[field] instanceof Timestamp) {
    //     item[field] = (new Date(item[field].seconds * 1000 + item[field].nanoseconds / 1000000)).getTime();
    //   }
    // }
    // fsAddMilliseconds(date) {
    //   date.milliseconds = (new Date(date.seconds * 1000 + date.nanoseconds / 1000000)).getTime();
    //   return date;
    // }
    // fsTransaction<T>(updateFunction: (transaction: firebase.firestore.Timestamp) => Promise<T>): Promise<T> {
    //   return this.fs().firestore.runTransaction(updateFunction);
    // }
    // fsCounter(path, field = 'count', qt = 1) {
    //   return this.fsTransaction(transaction => {
    //     const ref = this.fsDoc(path).ref;
    //     return transaction.get(ref).then((doc) => {
    //
    //       const update = {};
    //
    //       if (doc.exists) {
    //         const value = parseInt(doc.get(field), 10);
    //         qt = value >= 0 || value <= 0 ? qt + value : qt;
    //       }
    //
    //       update[field] = qt;
    //
    //       transaction.set(ref, update, {merge: true});
    //
    //     });
    //   });
    // }
    // fsUp(path, field = 'count') {
    //   return this.fsCounter(path, field, 1);
    // }
    // fsDown(path, field = 'count') {
    //   return this.fsCounter(path, field, -1);
    // }
    // -------------------------------------------------------------------------------------------------------------------
    /**
     * @return {?}
     */
    AOFirebaseService.prototype.msn = 
    // fsToMilliseconds(item, field) {
    //   if (item[field] instanceof Timestamp) {
    //     item[field] = (new Date(item[field].seconds * 1000 + item[field].nanoseconds / 1000000)).getTime();
    //   }
    // }
    // fsAddMilliseconds(date) {
    //   date.milliseconds = (new Date(date.seconds * 1000 + date.nanoseconds / 1000000)).getTime();
    //   return date;
    // }
    // fsTransaction<T>(updateFunction: (transaction: firebase.firestore.Timestamp) => Promise<T>): Promise<T> {
    //   return this.fs().firestore.runTransaction(updateFunction);
    // }
    // fsCounter(path, field = 'count', qt = 1) {
    //   return this.fsTransaction(transaction => {
    //     const ref = this.fsDoc(path).ref;
    //     return transaction.get(ref).then((doc) => {
    //
    //       const update = {};
    //
    //       if (doc.exists) {
    //         const value = parseInt(doc.get(field), 10);
    //         qt = value >= 0 || value <= 0 ? qt + value : qt;
    //       }
    //
    //       update[field] = qt;
    //
    //       transaction.set(ref, update, {merge: true});
    //
    //     });
    //   });
    // }
    // fsUp(path, field = 'count') {
    //   return this.fsCounter(path, field, 1);
    // }
    // fsDown(path, field = 'count') {
    //   return this.fsCounter(path, field, -1);
    // }
    // -------------------------------------------------------------------------------------------------------------------
    /**
     * @return {?}
     */
    function () {
        return this.conn().messaging();
    };
    // -------------------------------------------------------------------------------------------------------------------
    // -------------------------------------------------------------------------------------------------------------------
    /**
     * @return {?}
     */
    AOFirebaseService.prototype.disk = 
    // -------------------------------------------------------------------------------------------------------------------
    /**
     * @return {?}
     */
    function () {
        return this.conn().storage();
    };
    AOFirebaseService.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] }
    ];
    /** @nocollapse */
    AOFirebaseService.ctorParameters = function () { return [
        { type: AOFirebaseFactoryService }
    ]; };
    /** @nocollapse */ AOFirebaseService.ngInjectableDef = i0.ɵɵdefineInjectable({ factory: function AOFirebaseService_Factory() { return new AOFirebaseService(i0.ɵɵinject(i1.AOFirebaseFactoryService)); }, token: AOFirebaseService, providedIn: "root" });
    return AOFirebaseService;
}());
export { AOFirebaseService };
if (false) {
    /**
     * @type {?}
     * @protected
     */
    AOFirebaseService.prototype._name;
    /**
     * @type {?}
     * @private
     */
    AOFirebaseService.prototype._firebase;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYW8tZmlyZWJhc2Uuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2FvLWFuZ3VsYXIvIiwic291cmNlcyI6WyJsaWIvc2VydmljZXMvYW8tZmlyZWJhc2Uuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFXM0MsT0FBTyxLQUFLLFFBQVEsTUFBTSxjQUFjLENBQUM7QUFHekMsT0FBTyxFQUFFLHdCQUF3QixFQUFFLE1BQU0sK0JBQStCLENBQUM7OztBQUd6RTtJQU9FLDJCQUNVLFNBQW1DO1FBQW5DLGNBQVMsR0FBVCxTQUFTLENBQTBCO1FBSG5DLFVBQUssR0FBRyxRQUFRLENBQUM7SUFLM0IsQ0FBQzs7OztJQUVELG9DQUFROzs7SUFBUjtRQUNFLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQztJQUN4QixDQUFDOzs7OztJQUVELG1DQUFPOzs7O0lBQVAsVUFBUSxPQUEwQjtRQUNoQyxPQUFPLElBQUksQ0FBQyxTQUFTLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsRUFBRSxPQUFPLENBQUMsQ0FBQztJQUN0RCxDQUFDOzs7O0lBRUQsZ0NBQUk7OztJQUFKO1FBQ0UsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQztJQUMxQyxDQUFDOzs7O0lBRUQsZ0NBQUk7OztJQUFKO1FBQ0UsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDO0lBQ3BCLENBQUM7Ozs7SUFFRCxnQ0FBSTs7O0lBQUo7UUFDRSxPQUFPLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUM1QixDQUFDOzs7O0lBRUQsK0JBQUc7OztJQUFIO1FBQ0UsT0FBTyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUMsR0FBRyxFQUFFLENBQUM7SUFDM0IsQ0FBQztJQUVELHNIQUFzSDs7Ozs7SUFF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bGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcclxuaW1wb3J0IHsgQW5ndWxhckZpcmVBdXRoIH0gZnJvbSAnQGFuZ3VsYXIvZmlyZS9hdXRoJztcclxuaW1wb3J0IHsgQW5ndWxhckZpcmVEYXRhYmFzZSB9IGZyb20gJ0Bhbmd1bGFyL2ZpcmUvZGF0YWJhc2UnO1xyXG5pbXBvcnQgeyBBbmd1bGFyRmlyZVN0b3JhZ2UgfSBmcm9tICdAYW5ndWxhci9maXJlL3N0b3JhZ2UnO1xyXG5pbXBvcnQgeyBBbmd1bGFyRmlyZXN0b3JlLCBEb2N1bWVudERhdGEgfSBmcm9tICdAYW5ndWxhci9maXJlL2ZpcmVzdG9yZSc7XHJcbmltcG9ydCB7IEFuZ3VsYXJGaXJlTWVzc2FnaW5nIH0gZnJvbSAnQGFuZ3VsYXIvZmlyZS9tZXNzYWdpbmcnO1xyXG5pbXBvcnQgeyBGaXJlYmFzZUFwcENvbmZpZyB9IGZyb20gJ0Bhbmd1bGFyL2ZpcmUnO1xyXG5pbXBvcnQgeyBBbmd1bGFyRmlyZXN0b3JlQ29sbGVjdGlvbiB9IGZyb20gJ0Bhbmd1bGFyL2ZpcmUvZmlyZXN0b3JlL2NvbGxlY3Rpb24vY29sbGVjdGlvbic7XHJcbmltcG9ydCB7IEFuZ3VsYXJGaXJlc3RvcmVEb2N1bWVudCB9IGZyb20gJ0Bhbmd1bGFyL2ZpcmUvZmlyZXN0b3JlL2RvY3VtZW50L2RvY3VtZW50JztcclxuaW1wb3J0IHsgQWN0aW9uLCBEb2N1bWVudENoYW5nZUFjdGlvbiwgRG9jdW1lbnRTbmFwc2hvdCwgUXVlcnlGbiB9IGZyb20gJ0Bhbmd1bGFyL2ZpcmUvZmlyZXN0b3JlL2ludGVyZmFjZXMnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCAqIGFzIGZpcmViYXNlIGZyb20gJ2ZpcmViYXNlL2FwcCc7XHJcbmltcG9ydCB7IFVzZXIgfSBmcm9tICdmaXJlYmFzZS9hcHAnO1xyXG5cclxuaW1wb3J0IHsgQU9GaXJlYmFzZUZhY3RvcnlTZXJ2aWNlIH0gZnJvbSAnLi9hby1maXJlYmFzZS1mYWN0b3J5LnNlcnZpY2UnO1xyXG5pbXBvcnQgeyBBT0ZpcmViYXNlQ29ubmVjdGlvblNlcnZpY2UgfSBmcm9tICcuL2FvLWZpcmViYXNlLWNvbm5lY3Rpb24uc2VydmljZSc7XHJcblxyXG5ASW5qZWN0YWJsZSh7XHJcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnXHJcbn0pXHJcbmV4cG9ydCBjbGFzcyBBT0ZpcmViYXNlU2VydmljZSB7XHJcblxyXG4gIHByb3RlY3RlZCBfbmFtZSA9ICdtYXN0ZXInO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgX2ZpcmViYXNlOiBBT0ZpcmViYXNlRmFjdG9yeVNlcnZpY2UsXHJcbiAgKSB7XHJcbiAgfVxyXG5cclxuICBmaXJlYmFzZSgpOiBBT0ZpcmViYXNlRmFjdG9yeVNlcnZpY2Uge1xyXG4gICAgcmV0dXJuIHRoaXMuX2ZpcmViYXNlO1xyXG4gIH1cclxuXHJcbiAgZmFjdG9yeShjb25maWdzOiBGaXJlYmFzZUFwcENvbmZpZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgcmV0dXJuIHRoaXMuX2ZpcmViYXNlLmZhY3RvcnkodGhpcy5uYW1lKCksIGNvbmZpZ3MpO1xyXG4gIH1cclxuXHJcbiAgY29ubigpOiBBT0ZpcmViYXNlQ29ubmVjdGlvblNlcnZpY2Uge1xyXG4gICAgcmV0dXJuIHRoaXMuX2ZpcmViYXNlLmNvbm4odGhpcy5uYW1lKCkpO1xyXG4gIH1cclxuXHJcbiAgbmFtZSgpIHtcclxuICAgIHJldHVybiB0aGlzLl9uYW1lO1xyXG4gIH1cclxuXHJcbiAgaGFzaCgpIHtcclxuICAgIHJldHVybiB0aGlzLmNvbm4oKS5oYXNoKCk7XHJcbiAgfVxyXG5cclxuICBhcHAoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5jb25uKCkuYXBwKCk7XHJcbiAgfVxyXG5cclxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gIGF1dGgoKTogQW5ndWxhckZpcmVBdXRoIHtcclxuICAgIHJldHVybiB0aGlzLmNvbm4oKS5hdXRoKCk7XHJcbiAgfVxyXG5cclxuICBhdXRoU3RhdGUoKTogT2JzZXJ2YWJsZTxVc2VyIHwgbnVsbD4ge1xyXG4gICAgcmV0dXJuIHRoaXMuYXV0aCgpLmF1dGhTdGF0ZTtcclxuICB9XHJcblxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgZGIoKTogQW5ndWxhckZpcmVEYXRhYmFzZSB7XHJcbiAgICByZXR1cm4gdGhpcy5jb25uKCkuZGF0YWJhc2UoKTtcclxuICB9XHJcblxyXG4gIGRiTm93KCkge1xyXG4gICAgcmV0dXJuIGZpcmViYXNlLmRhdGFiYXNlLlNlcnZlclZhbHVlLlRJTUVTVEFNUDtcclxuICB9XHJcblxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgZnMoKTogQW5ndWxhckZpcmVzdG9yZSB7XHJcbiAgICByZXR1cm4gdGhpcy5jb25uKCkuZmlyZXN0b3JlKCk7XHJcbiAgfVxyXG5cclxuICBmc0lkKCk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gdGhpcy5mcygpLmNyZWF0ZUlkKCk7XHJcbiAgfVxyXG5cclxuICBmc0RvYzxUPihwYXRoOiBzdHJpbmcpOiBBbmd1bGFyRmlyZXN0b3JlRG9jdW1lbnQ8VD4ge1xyXG4gICAgcmV0dXJuIHRoaXMuZnMoKS5kb2MocGF0aCk7XHJcbiAgfVxyXG5cclxuICBmc0RvY1ZhbHVlKHBhdGg6IHN0cmluZyk6IE9ic2VydmFibGU8RG9jdW1lbnREYXRhIHwgdW5kZWZpbmVkPiB7XHJcbiAgICByZXR1cm4gdGhpcy5mc0RvYyhwYXRoKS52YWx1ZUNoYW5nZXMoKTtcclxuICB9XHJcblxyXG4gIGZzRG9jU25hcHNob3QocGF0aDogc3RyaW5nKTogT2JzZXJ2YWJsZTxBY3Rpb248RG9jdW1lbnRTbmFwc2hvdDxEb2N1bWVudERhdGE+Pj4ge1xyXG4gICAgcmV0dXJuIHRoaXMuZnMoKS5kb2MocGF0aCkuc25hcHNob3RDaGFuZ2VzKCk7XHJcbiAgfVxyXG5cclxuICBmc0RvY1NldChwYXRoOiBzdHJpbmcsIGRhdGE6IGFueSwgb3B0aW9ucyA9IHttZXJnZTogdHJ1ZX0pOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHJldHVybiB0aGlzLmZzKCkuZG9jKHBhdGgpLnNldChkYXRhLCBvcHRpb25zKTtcclxuICB9XHJcblxyXG4gIGZzQ29sPFQ+KHBhdGg6IHN0cmluZywgcXVlcnlGbj86IFF1ZXJ5Rm4pOiBBbmd1bGFyRmlyZXN0b3JlQ29sbGVjdGlvbjxUPiB7XHJcbiAgICByZXR1cm4gdGhpcy5mcygpLmNvbGxlY3Rpb24ocGF0aCwgcXVlcnlGbik7XHJcbiAgfVxyXG5cclxuICBmc0NvbFZhbHVlcyhwYXRoOiBzdHJpbmcsIHF1ZXJ5Rm4/OiBRdWVyeUZuKTogT2JzZXJ2YWJsZTxEb2N1bWVudERhdGFbXT4ge1xyXG4gICAgcmV0dXJuIHRoaXMuZnNDb2wocGF0aCwgcXVlcnlGbikudmFsdWVDaGFuZ2VzKCk7XHJcbiAgfVxyXG5cclxuICBmc0NvbFNuYXBzaG90KHBhdGg6IHN0cmluZywgcXVlcnlGbj86IFF1ZXJ5Rm4pOiBPYnNlcnZhYmxlPERvY3VtZW50Q2hhbmdlQWN0aW9uPERvY3VtZW50RGF0YT5bXT4ge1xyXG4gICAgcmV0dXJuIHRoaXMuZnNDb2wocGF0aCwgcXVlcnlGbikuc25hcHNob3RDaGFuZ2VzKCk7XHJcbiAgfVxyXG5cclxuICBmc0NvbFN0YXRlKHBhdGg6IHN0cmluZywgcXVlcnlGbj86IFF1ZXJ5Rm4pOiBPYnNlcnZhYmxlPERvY3VtZW50Q2hhbmdlQWN0aW9uPERvY3VtZW50RGF0YT5bXT4ge1xyXG4gICAgcmV0dXJuIHRoaXMuZnNDb2wocGF0aCwgcXVlcnlGbikuc3RhdGVDaGFuZ2VzKCk7XHJcbiAgfVxyXG5cclxuICBmc0JhdGNoKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuZnMoKS5maXJlc3RvcmUuYmF0Y2goKTtcclxuICB9XHJcblxyXG4gIGZzTm93KCkge1xyXG4gICAgcmV0dXJuIGZpcmViYXNlLmZpcmVzdG9yZS5GaWVsZFZhbHVlLnNlcnZlclRpbWVzdGFtcCgpO1xyXG4gIH1cclxuXHJcbiAgZnNUaW1lc3RhbXAoKSB7XHJcbiAgICByZXR1cm4gZmlyZWJhc2UuZmlyZXN0b3JlLlRpbWVzdGFtcDtcclxuICB9XHJcblxyXG4gIC8vIGZzVG9NaWxsaXNlY29uZHMoaXRlbSwgZmllbGQpIHtcclxuICAvLyAgIGlmIChpdGVtW2ZpZWxkXSBpbnN0YW5jZW9mIFRpbWVzdGFtcCkge1xyXG4gIC8vICAgICBpdGVtW2ZpZWxkXSA9IChuZXcgRGF0ZShpdGVtW2ZpZWxkXS5zZWNvbmRzICogMTAwMCArIGl0ZW1bZmllbGRdLm5hbm9zZWNvbmRzIC8gMTAwMDAwMCkpLmdldFRpbWUoKTtcclxuICAvLyAgIH1cclxuICAvLyB9XHJcblxyXG4gIC8vIGZzQWRkTWlsbGlzZWNvbmRzKGRhdGUpIHtcclxuICAvLyAgIGRhdGUubWlsbGlzZWNvbmRzID0gKG5ldyBEYXRlKGRhdGUuc2Vjb25kcyAqIDEwMDAgKyBkYXRlLm5hbm9zZWNvbmRzIC8gMTAwMDAwMCkpLmdldFRpbWUoKTtcclxuICAvLyAgIHJldHVybiBkYXRlO1xyXG4gIC8vIH1cclxuXHJcbiAgLy8gZnNUcmFuc2FjdGlvbjxUPih1cGRhdGVGdW5jdGlvbjogKHRyYW5zYWN0aW9uOiBmaXJlYmFzZS5maXJlc3RvcmUuVGltZXN0YW1wKSA9PiBQcm9taXNlPFQ+KTogUHJvbWlzZTxUPiB7XHJcbiAgLy8gICByZXR1cm4gdGhpcy5mcygpLmZpcmVzdG9yZS5ydW5UcmFuc2FjdGlvbih1cGRhdGVGdW5jdGlvbik7XHJcbiAgLy8gfVxyXG5cclxuICAvLyBmc0NvdW50ZXIocGF0aCwgZmllbGQgPSAnY291bnQnLCBxdCA9IDEpIHtcclxuICAvLyAgIHJldHVybiB0aGlzLmZzVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24gPT4ge1xyXG4gIC8vICAgICBjb25zdCByZWYgPSB0aGlzLmZzRG9jKHBhdGgpLnJlZjtcclxuICAvLyAgICAgcmV0dXJuIHRyYW5zYWN0aW9uLmdldChyZWYpLnRoZW4oKGRvYykgPT4ge1xyXG4gIC8vXHJcbiAgLy8gICAgICAgY29uc3QgdXBkYXRlID0ge307XHJcbiAgLy9cclxuICAvLyAgICAgICBpZiAoZG9jLmV4aXN0cykge1xyXG4gIC8vICAgICAgICAgY29uc3QgdmFsdWUgPSBwYXJzZUludChkb2MuZ2V0KGZpZWxkKSwgMTApO1xyXG4gIC8vICAgICAgICAgcXQgPSB2YWx1ZSA+PSAwIHx8IHZhbHVlIDw9IDAgPyBxdCArIHZhbHVlIDogcXQ7XHJcbiAgLy8gICAgICAgfVxyXG4gIC8vXHJcbiAgLy8gICAgICAgdXBkYXRlW2ZpZWxkXSA9IHF0O1xyXG4gIC8vXHJcbiAgLy8gICAgICAgdHJhbnNhY3Rpb24uc2V0KHJlZiwgdXBkYXRlLCB7bWVyZ2U6IHRydWV9KTtcclxuICAvL1xyXG4gIC8vICAgICB9KTtcclxuICAvLyAgIH0pO1xyXG4gIC8vIH1cclxuXHJcbiAgLy8gZnNVcChwYXRoLCBmaWVsZCA9ICdjb3VudCcpIHtcclxuICAvLyAgIHJldHVybiB0aGlzLmZzQ291bnRlcihwYXRoLCBmaWVsZCwgMSk7XHJcbiAgLy8gfVxyXG5cclxuICAvLyBmc0Rvd24ocGF0aCwgZmllbGQgPSAnY291bnQnKSB7XHJcbiAgLy8gICByZXR1cm4gdGhpcy5mc0NvdW50ZXIocGF0aCwgZmllbGQsIC0xKTtcclxuICAvLyB9XHJcblxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgbXNuKCk6IEFuZ3VsYXJGaXJlTWVzc2FnaW5nIHtcclxuICAgIHJldHVybiB0aGlzLmNvbm4oKS5tZXNzYWdpbmcoKTtcclxuICB9XHJcblxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuXHJcbiAgZGlzaygpOiBBbmd1bGFyRmlyZVN0b3JhZ2Uge1xyXG4gICAgcmV0dXJuIHRoaXMuY29ubigpLnN0b3JhZ2UoKTtcclxuICB9XHJcblxyXG4gIC8vIGZzTGlua0ZyZWUoYnVja2V0LCBwYXRoKSB7XHJcbiAgLy8gICByZXR1cm4gJ2h0dHBzOi8vZmlyZWJhc2VzdG9yYWdlLmdvb2dsZWFwaXMuY29tL3YwL2IvJyArIGJ1Y2tldCArICcvby8nICsgcGF0aC5zcGxpdCgnLycpLmpvaW4oJyUyRicpICsgJz9hbHQ9bWVkaWEnO1xyXG4gIC8vIH1cclxuXHJcbiAgLy8gYXN5bmMgZnNVcGxvYWQoZmlsZSwgY29uZmlncyk6IFByb21pc2U8YW55PiB7XHJcbiAgLy8gICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xyXG4gIC8vICAgY29uc3QgZXh0ZW5zaW9uID0gLyg/OlxcLihbXi5dKykpPyQvO1xyXG4gIC8vICAgY29uc3QgZGF0YTogYW55ID0ge307XHJcbiAgLy9cclxuICAvLyAgIGRhdGEuaWQgPSB0aGlzLmZzSWQoKTtcclxuICAvLyAgIGRhdGEubWQ1ID0gKGF3YWl0IEFPVXRpbC5tZDVGaWxlKGZpbGUpKSBhcyBzdHJpbmc7XHJcbiAgLy8gICBkYXRhLmV4dGVuc2lvbiA9IChleHRlbnNpb24uZXhlYyhmaWxlLm5hbWUpWzFdKS50b0xvd2VyQ2FzZSgpO1xyXG4gIC8vICAgZGF0YS5uYW1lID0gZmlsZS5uYW1lLnN1YnN0cigwLCBmaWxlLm5hbWUubGVuZ3RoIC0gZGF0YS5leHRlbnNpb24ubGVuZ3RoIC0gMSk7XHJcbiAgLy8gICBkYXRhLnNpemUgPSBmaWxlLnNpemU7XHJcbiAgLy8gICBkYXRhLm1pbWV0eXBlID0gZmlsZS50eXBlO1xyXG4gIC8vICAgZGF0YS5tb2RpZmllZF9hdCA9IGZpbGUubGFzdE1vZGlmaWVkO1xyXG4gIC8vICAgZGF0YS5mb2xkZXIgPSAnLycgKyBbJ2ZpbGVzJywgbm93LmdldFVUQ0Z1bGxZZWFyKCksIG5vdy5nZXRVVENNb250aCgpICsgMSwgbm93LmdldFVUQ0RhdGUoKV0uam9pbignLycpO1xyXG4gIC8vICAgZGF0YS5wYXRoID0gZGF0YS5mb2xkZXIgKyAnLycgKyBkYXRhLmlkICsgJy4nICsgZGF0YS5leHRlbnNpb247XHJcbiAgLy8gICBkYXRhLmFjdGl2ZSA9IHRydWU7XHJcbiAgLy8gICBkYXRhLmNyZWF0ZWRfYXQgPSB0aGlzLmZzTm93KCk7XHJcbiAgLy8gICBkYXRhLnVwZGF0ZWRfYXQgPSBudWxsO1xyXG4gIC8vICAgZGF0YS5kZWxldGVkX2F0ID0gbnVsbDtcclxuICAvL1xyXG4gIC8vICAgaWYgKGNvbmZpZ3MudHlwZXMgJiYgY29uZmlncy50eXBlcy5pbmRleE9mKGRhdGEubWltZXR5cGUpID09IC0xKSB7XHJcbiAgLy8gICAgIHRocm93IG5ldyBFcnJvcignVGlwbyBJbnbDoWxpZG86ICcgKyBmaWxlLm5hbWUpO1xyXG4gIC8vICAgfVxyXG4gIC8vICAgaWYgKGNvbmZpZ3MuZXh0ZW5zaW9ucyAmJiBjb25maWdzLmV4dGVuc2lvbnMuaW5kZXhPZihkYXRhLmV4dGVuc2lvbikgPT0gLTEpIHtcclxuICAvLyAgICAgdGhyb3cgbmV3IEVycm9yKCdFeHRlbnPDo28gaW52w6FsaWRhOiAnICsgZmlsZS5uYW1lKTtcclxuICAvLyAgIH1cclxuICAvLyAgIGlmIChjb25maWdzLnNpemUgJiYgY29uZmlncy5zaXplIDwgZGF0YS5zaXplKSB7XHJcbiAgLy8gICAgIHRocm93IG5ldyBFcnJvcignTXVpdG8gZ3JhbmRlOiAnICsgZmlsZS5uYW1lKTtcclxuICAvLyAgIH1cclxuICAvL1xyXG4gIC8vICAgY29uc3Qgc25hcHNob3QgPSA8YW55PmF3YWl0IHRoaXMuZnNDb2woJy9maWxlcycsIHEgPT4gcS53aGVyZSgnbWQ1JywgJz09JywgZGF0YS5tZDUpLmxpbWl0KDEpKS5nZXQoKS50b1Byb21pc2UoKTtcclxuICAvLyAgIGlmIChjb25maWdzLmR1cGxpY2F0ZSA9PT0gZmFsc2UgJiYgc25hcHNob3QuZG9jcy5sZW5ndGggPiAwKSB7XHJcbiAgLy8gICAgIHRocm93IG5ldyBFcnJvcignSsOhIGV4aXN0ZTogJyArIGZpbGUubmFtZSk7XHJcbiAgLy8gICB9XHJcbiAgLy9cclxuICAvLyAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgLy9cclxuICAvLyAgICAgaWYgKHNuYXBzaG90LmRvY3MubGVuZ3RoID4gMCkge1xyXG4gIC8vICAgICAgIHJldHVybiByZXNvbHZlKHNuYXBzaG90LmRvY3NbMF0uZGF0YSgpKTtcclxuICAvLyAgICAgfVxyXG4gIC8vXHJcbiAgLy8gICAgIGNvbnN0IHRhc2sgPSB0aGlzLnN0b3JhZ2UoKS51cGxvYWQoZGF0YS5wYXRoLCBmaWxlKTtcclxuICAvL1xyXG4gIC8vICAgICB0YXNrLnRoZW4oc25hcHNob3QgPT4ge1xyXG4gIC8vICAgICAgIGRhdGEubWV0YWRhdGEgPSBBT1V0aWwudW5kZWZpbmVkVG9OdWxsKE9iamVjdC5hc3NpZ24oe30sIHNuYXBzaG90Lm1ldGFkYXRhKSk7XHJcbiAgLy8gICAgICAgdGhpcy5mc0RvYygnL2ZpbGVzLycgKyBkYXRhLmlkKS5zZXQoZGF0YSkudGhlbigoKSA9PiB7XHJcbiAgLy8gICAgICAgICByZXR1cm4gcmVzb2x2ZShkYXRhKTtcclxuICAvLyAgICAgICB9KTtcclxuICAvLyAgICAgfSk7XHJcbiAgLy9cclxuICAvLyAgIH0pO1xyXG4gIC8vIH1cclxuXHJcbiAgLy8gdXBsb2FkZXIoKTogQU9GaXJlYmFzZVVwbG9hZGVyU2VydmljZSB7XHJcbiAgLy8gICByZXR1cm4gbmV3IEFPRmlyZWJhc2VVcGxvYWRlclNlcnZpY2UodGhpcyk7XHJcbiAgLy8gfVxyXG5cclxufVxyXG4iXX0=